"use strict";(self["webpackChunkpolkaswap_exchange_web"]=self["webpackChunkpolkaswap_exchange_web"]||[]).push([[9842],{9842:function(t,e,s){s.r(e),s.d(e,{default:function(){return f}});var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"sora-card__number-input"},[s("div",{staticClass:"phone-container s-flex"},[s("s-input",{directives:[{name:"maska",rawName:"v-maska",value:"+###",expression:"'+###'"}],ref:"code",staticClass:"phone-code",attrs:{placeholder:t.countryCodePlaceholder,disabled:t.phoneInputDisabled},model:{value:t.countryCode,callback:function(e){t.countryCode=e},expression:"countryCode"}}),s("s-input",{directives:[{name:"maska",rawName:"v-maska",value:"############",expression:"'############'"}],ref:"phone",staticClass:"phone-number",attrs:{placeholder:"Phone number",disabled:t.phoneInputDisabled},model:{value:t.phoneNumber,callback:function(e){t.phoneNumber=e},expression:"phoneNumber"}})],1),s("s-button",{staticClass:"sora-card__send-sms-btn s-typography-button--large",attrs:{type:"secondary",disabled:t.sendSmsDisabled},on:{click:t.sendSms}},[t._v(" "+t._s(t.sendSmsButtonText)+" ")])],1),s("div",[s("p",{staticClass:"sora-card__number-input-desc"},[t._v(t._s(t.phoneInputDescription))]),t.smsSent?s("s-icon",{staticClass:"sora-card__icon",attrs:{name:"basic-check-mark-24",size:"14px"}}):t._e()],1),s("s-input",{directives:[{name:"maska",rawName:"v-maska",value:"######",expression:"'######'"}],ref:"otp",attrs:{placeholder:"Verification code",disabled:t.otpInputDisabled},model:{value:t.verificationCode,callback:function(e){t.verificationCode=e},expression:"verificationCode"}}),s("s-button",{staticClass:"sora-card__btn s-typography-button--large",attrs:{disabled:t.buttonDisabled,type:"primary",loading:t.sendOtpBtnLoading},on:{click:t.verifyCode}},[s("span",{staticClass:"text"},[t._v(" "+t._s(t.buttonText))])])],1)},o=[],i=s(60760),a=s(70655),r=s(53545),d=s(82753),h=s(37365),u=s(32806),c=s(74614),p=s(25108);const l=8,m=6,g=59;let C=class extends((0,r.Wr)(u.Z,h.tA.LoadingMixin)){constructor(...t){super(...t),(0,i.Z)(this,"authLogin",void 0),(0,i.Z)(this,"soraNetwork",void 0),(0,i.Z)(this,"currentStatus",void 0),(0,i.Z)(this,"isEuroBalanceEnough",void 0),(0,i.Z)(this,"getUserStatus",void 0),(0,i.Z)(this,"initPayWingsAuthSdk",void 0),(0,i.Z)(this,"userApplied",void 0),(0,i.Z)(this,"inputCode",void 0),(0,i.Z)(this,"inputPhone",void 0),(0,i.Z)(this,"inputOtp",void 0),(0,i.Z)(this,"countryCodeInternal",""),(0,i.Z)(this,"phoneNumberInternal",""),(0,i.Z)(this,"smsResendText",""),(0,i.Z)(this,"smsResendCount",g),(0,i.Z)(this,"notPassedKycAndNotHasXorEnough",!1),(0,i.Z)(this,"verificationCode",""),(0,i.Z)(this,"smsSent",!1),(0,i.Z)(this,"sendOtpBtnLoading",!1)}handleSmsCountChange(t){const e=t.toString().length>1?"":"0",s=`${e}${t}`;this.smsResendText=`RESEND IN 0:${s}`}handleXorDeposit(t){t&&(this.notPassedKycAndNotHasXorEnough=!1,this.verificationCode="",this.smsSent=!1)}verifyCode(){this.authLogin.PayWingsOtpCredentialVerification(this.verificationCode).catch((t=>{this.sendOtpBtnLoading=!1,this.verificationCode="",this.$notify({message:"Code is incorrect",type:"error",title:""}),p.error("[SoraCard]: Auth",t)})),this.sendOtpBtnLoading=!0}sendSms(){this.authLogin.PayWingsSendOtp(`${this.countryCode}${this.phoneNumber}`,"Your verification code is: @Otp").catch((t=>{p.error("[SoraCard]: Auth",t)})),this.startSmsCountDown()}get countryCode(){return this.countryCodeInternal}set countryCode(t){t.length>3&&this.inputPhone.focus(),this.countryCodeInternal=t}get phoneNumber(){return this.phoneNumberInternal}set phoneNumber(t){t.length||this.inputCode.focus(),this.phoneNumberInternal=t}get countryCodePlaceholder(){return this.countryCode?"Code":"+44"}get buttonDisabled(){return this.verificationCode.length!==m||this.notPassedKycAndNotHasXorEnough}get otpInputDisabled(){return!this.smsSent||!this.isPhoneNumberValid}get buttonText(){return this.verificationCode.length!==m?"ENTER THE VERIFICATION CODE":this.notPassedKycAndNotHasXorEnough?this.t("insufficientBalanceText",{tokenSymbol:d.XOR.symbol}):"CONFIRM SMS CODE"}set buttonText(t){this.buttonText=t}get sendSmsButtonText(){return this.smsSent?this.smsResendText:"SEND SMS CODE"}get isMainnet(){return this.soraNetwork===h.it.SoraNetwork.Prod}get isPhoneNumberValid(){const t=this.countryCode.replace("+","");return!!(+t&&this.phoneNumber&&`${t}${this.phoneNumber}`.length>=l)}get sendSmsDisabled(){return!this.isPhoneNumberValid||this.smsSent}get phoneInputDisabled(){return this.smsSent}get phoneInputDescription(){return this.smsSent?this.isMainnet?"We’ve sent you an SMS code. Check your messages!":"Your code for testing purposes: 123456":"We’ll send you an SMS code."}startSmsCountDown(){const t=setInterval((()=>{this.smsResendCount--,this.smsResendCount<0&&(this.smsSent=!1,this.verificationCode="",this.smsResendCount=g,clearInterval(t))}),1e3)}async mounted(){await this.$nextTick(),this.inputCode.focus(),await this.initPayWingsAuthSdk(),this.authLogin&&this.authLogin.on("SendOtp-Success",(()=>{this.smsSent=!0,this.$nextTick((()=>{this.inputOtp.focus()}))})).on("MinimalRegistrationReq",(()=>{if(this.sendOtpBtnLoading=!1,this.userApplied&&this.$notify({title:"",message:"KYC process has not been finished.",type:"info"}),!this.isEuroBalanceEnough)return void(this.notPassedKycAndNotHasXorEnough=!0);const t={goToEmail:!0,startKyc:!1,showBanner:!1};this.$emit("confirm",t),this.sendOtpBtnLoading=!1})).on("Otp-Verification-Success",(async()=>{if(await this.getUserStatus(),this.currentStatus){const t={goToEmail:!1,startKyc:!1,showBanner:!0};this.$emit("confirm",t)}else{if(this.userApplied&&this.$notify({title:"",message:"KYC process has not been finished.",type:"info"}),!this.isEuroBalanceEnough)return this.notPassedKycAndNotHasXorEnough=!0,void(this.sendOtpBtnLoading=!1);const t={goToEmail:!1,startKyc:!0,showBanner:!1};this.$emit("confirm",t)}}))}};(0,a.__decorate)([c.SB.soraCard.authLogin],C.prototype,"authLogin",void 0),(0,a.__decorate)([c.SB.wallet.settings.soraNetwork],C.prototype,"soraNetwork",void 0),(0,a.__decorate)([c.Yn.soraCard.currentStatus],C.prototype,"currentStatus",void 0),(0,a.__decorate)([c.Yn.soraCard.isEuroBalanceEnough],C.prototype,"isEuroBalanceEnough",void 0),(0,a.__decorate)([c.aD.soraCard.getUserStatus],C.prototype,"getUserStatus",void 0),(0,a.__decorate)([c.aD.soraCard.initPayWingsAuthSdk],C.prototype,"initPayWingsAuthSdk",void 0),(0,a.__decorate)([(0,r.fI)({default:!1,type:Boolean})],C.prototype,"userApplied",void 0),(0,a.__decorate)([(0,r.Rl)("code")],C.prototype,"inputCode",void 0),(0,a.__decorate)([(0,r.Rl)("phone")],C.prototype,"inputPhone",void 0),(0,a.__decorate)([(0,r.Rl)("otp")],C.prototype,"inputOtp",void 0),(0,a.__decorate)([(0,r.RL)("smsResendCount",{immediate:!0})],C.prototype,"handleSmsCountChange",null),(0,a.__decorate)([(0,r.RL)("isEuroBalanceEnough",{immediate:!0})],C.prototype,"handleXorDeposit",null),C=(0,a.__decorate)([r.wA],C);var y=C,v=y,b=s(1001),S=(0,b.Z)(v,n,o,!1,null,"263ca474",null),f=S.exports}}]);